% File: dinoTrueF.m
% 

%% Get estimated F from dinoTestF
dinoTestF

%% Compute true fundamental matrix
Tvec = dLeft - dRight;
T = zeros(3,3);
T(1)=0;
T(2) = Tvec(3);
T(3) = Tvec(2);
T(4) = Tvec(3);
T(5) = 0;
T(6) = -Tvec(1);
T(7)=-Tvec(2);
T(8)=Tvec(1);
T(9)=0;
E = Rleft* T * Rright';
Ftrue = pinv(MintLeft)' * E * pinv(MintRight);

%% Plot results
nTest = 64;  %% Number of epipolar lines to plot
nCol = 16;   %% Number of different colours to use.
col = hsv(nCol);  %% Colour map.

% Show left image
hFig = figure(3);
clf; hold on;
% Plot all interest point locations as blue .'s
axis([-150 150 -100 100]); axis xy; axis equal;
ax = axis;
cropBox = [ax(1) ax(3) ax(2) ax(4)];
title('Regularly spaced grid of points in left image');
for kl = 1:length(idLines)
  % Plot interest point location corresponding to epipolar line as a "o"
  % in the same colour as the epipolar line.
  plot(imPts(1,k,1), imPts(2,k,1), 'o', 'Color', col(mod(k,nCol)+1,:));
  % Plot epipolar line.
  lk = imPts(:,k,2)' * Ftrue';
  epk = cropLineInBox(lk(1:2), lk(3), cropBox); 
  set(line(epk(:,1), epk(:,2)), 'Color', col(mod(k,nCol)+1,:));
end
